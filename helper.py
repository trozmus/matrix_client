import os
import random
import csv
import json
import logging


message_set = ["In delay there lies no plenty. False face must hide what the false heart doth know. What light through yonder window breaks? It is the east, and Juliet is the sun.", "Speak what we feel, not what we ought to say. I count myself in nothing else so happy as in a soul remembering my good friends. Great floods have flown from simple sources.", "The course of true love never did run smooth. Men of few words are the best men.", "The course of true love never did run smooth. What\'s done cannot be undone.", "Better a witty fool than a foolish wit. Many a true word hath been spoken in jest.", "Glory is like a circle in the water, which never ceaseth to enlarge itself. Great floods have flown from simple sources. How far that little candle throws his beams! So shines a good deed in a naughty world.", "The golden age is before us, not behind us. The evil that men do lives after them; the good is oft interred with their bones. All the world\'s a stage, and all the men and women merely players.", "Such stuff as dreams are made on. Though she be but little, she is fierce! I am not bound to please thee with my answers.", "Fortune brings in some boats that are not steered. In delay there lies no plenty. Great floods have flown from simple sources.", "Many a true word hath been spoken in jest. Small cheer and great welcome makes a merry feast. The miserable have no other medicine, but only hope.", "Have more than thou showest, speak less than thou knowest. In delay there lies no plenty. What\'s done cannot be undone.", "We know what we are, but know not what we may be. The time of life is short! To spend that shortness basely were too long. I am not what I am.", "Some are born great, some achieve greatness, and some have greatness thrust upon them. I count myself in nothing else so happy as in a soul remembering my good friends.", "The time of life is short! To spend that shortness basely were too long. The golden age is before us, not behind us.", "What light through yonder window breaks? It is the east, and Juliet is the sun. All that glisters is not gold. Poor and content is rich, and rich enough.", "Reputation is an idle and most false imposition; oft got without merit and lost without deserving. Words are easy, like the wind; faithful friends are hard to find. Poor and content is rich, and rich enough.", "Great floods have flown from simple sources. Come what come may, time and the hour runs through the roughest day. How far that little candle throws his beams! So shines a good deed in a naughty world.", "The evil that men do lives after them; the good is oft interred with their bones. Cowards die many times before their deaths; the valiant never taste of death but once. How far that little candle throws his beams! So shines a good deed in a naughty world.", "All that glisters is not gold. Though she be but little, she is fierce!", "Wisely and slow; they stumble that run fast. Do you think I am easier to be played on than a pipe?", "Some are born great, some achieve greatness, and some have greatness thrust upon them. To be, or not to be: that is the question.", "Come what come may, time and the hour runs through the roughest day. No legacy is so rich as honesty. A fool thinks himself to be wise, but a wise man knows himself to be a fool.", "Better three hours too soon than a minute too late. Fortune brings in some boats that are not steered. Though she be but little, she is fierce!", "There is nothing either good or bad, but thinking makes it so. In delay there lies no plenty.", "I do love nothing in the world so well as you\\u2014is not that strange? The robbed that smiles steals something from the thief.", "Reputation is an idle and most false imposition; oft got without merit and lost without deserving. Things won are done; joy\\u2019s soul lies in the doing.", "Though she be but little, she is fierce! Good night, good night! Parting is such sweet sorrow, that I shall say good night till it be morrow.", "Love all, trust a few, do wrong to none. I count myself in nothing else so happy as in a soul remembering my good friends.", "The robbed that smiles steals something from the thief. This above all: to thine own self be true. Good night, good night! Parting is such sweet sorrow, that I shall say good night till it be morrow.", "Things without remedy should be without regard: what\\u2019s done is done. Many a true word hath been spoken in jest. The course of true love never did run smooth.", "I shall the effect of this good lesson keep as watchman to my heart. The wheel is come full circle. What\'s done cannot be undone.", "All\\u2019s well that ends well. I count myself in nothing else so happy as in a soul remembering my good friends. The fault, dear Brutus, is not in our stars, but in ourselves.", "There is nothing either good or bad, but thinking makes it so. The miserable have no other medicine, but only hope. False face must hide what the false heart doth know.", "Better a witty fool than a foolish wit. The golden age is before us, not behind us.", "They do not love that do not show their love. Men of few words are the best men. Fie, foh, and fum, I smell the blood of a British man.", "Words are easy, like the wind; faithful friends are hard to find. Fortune brings in some boats that are not steered. All the world\'s a stage, and all the men and women merely players.", "Boldness be my friend! Arm me, audacity, from head to foot! The evil that men do lives after them; the good is oft interred with their bones.", "There\\u2019s a divinity that shapes our ends, rough-hew them how we will. Some are born great, some achieve greatness, and some have greatness thrust upon them. O, beware, my lord, of jealousy! It is the green-eyed monster which doth mock the meat it feeds on.", "Give me my robe, put on my crown; I have immortal longings in me. Great floods have flown from simple sources.", "We know what we are, but know not what we may be. Though she be but little, she is fierce!", "We know what we are, but know not what we may be. Better three hours too soon than a minute too late.", "Things without remedy should be without regard: what\\u2019s done is done. When sorrows come, they come not single spies, but in battalions. Men of few words are the best men.", "The golden age is before us, not behind us. Reputation is an idle and most false imposition; oft got without merit and lost without deserving.", "All that glisters is not gold. Many a true word hath been spoken in jest.", "To be, or not to be: that is the question. There is nothing either good or bad, but thinking makes it so.", "False face must hide what the false heart doth know. Some are born great, some achieve greatness, and some have greatness thrust upon them.", "They do not love that do not show their love. Brevity is the soul of wit.", "There\\u2019s a divinity that shapes our ends, rough-hew them how we will. Good night, good night! Parting is such sweet sorrow, that I shall say good night till it be morrow.", "The golden age is before us, not behind us. This above all: to thine own self be true. Do you think I am easier to be played on than a pipe?", "All that glisters is not gold. They do not love that do not show their love.",
               "All the world\'s a stage, and all the men and women merely players. Small cheer and great welcome makes a merry feast. Speak what we feel, not what we ought to say.", "I shall the effect of this good lesson keep as watchman to my heart. False face must hide what the false heart doth know. How far that little candle throws his beams! So shines a good deed in a naughty world.", "In delay there lies no plenty. Give me my robe, put on my crown; I have immortal longings in me.", "The time of life is short! To spend that shortness basely were too long. Better three hours too soon than a minute too late. How far that little candle throws his beams! So shines a good deed in a naughty world.", "False face must hide what the false heart doth know. Many a true word hath been spoken in jest. I am not bound to please thee with my answers.", "O, beware, my lord, of jealousy! It is the green-eyed monster which doth mock the meat it feeds on. I count myself in nothing else so happy as in a soul remembering my good friends. All that glisters is not gold.", "This above all: to thine own self be true. Many a true word hath been spoken in jest.", "The fault, dear Brutus, is not in our stars, but in ourselves. There is nothing either good or bad, but thinking makes it so. False face must hide what the false heart doth know.", "Do you think I am easier to be played on than a pipe? I shall the effect of this good lesson keep as watchman to my heart. There is nothing either good or bad, but thinking makes it so.", "A fool thinks himself to be wise, but a wise man knows himself to be a fool. Things without remedy should be without regard: what\\u2019s done is done.", "How far that little candle throws his beams! So shines a good deed in a naughty world. Fortune brings in some boats that are not steered.", "In delay there lies no plenty. The golden age is before us, not behind us.", "Glory is like a circle in the water, which never ceaseth to enlarge itself. Fie, foh, and fum, I smell the blood of a British man. Though she be but little, she is fierce!", "There\\u2019s a divinity that shapes our ends, rough-hew them how we will. Reputation is an idle and most false imposition; oft got without merit and lost without deserving.", "Speak what we feel, not what we ought to say. Better three hours too soon than a minute too late.", "Cowards die many times before their deaths; the valiant never taste of death but once. The time of life is short! To spend that shortness basely were too long. To be, or not to be: that is the question.", "False face must hide what the false heart doth know. Come what come may, time and the hour runs through the roughest day.", "All\\u2019s well that ends well. Good night, good night! Parting is such sweet sorrow, that I shall say good night till it be morrow. I do love nothing in the world so well as you\\u2014is not that strange?", "I do love nothing in the world so well as you\\u2014is not that strange? By my troth, I care not; a man can die but once. To be, or not to be: that is the question.", "What\'s done cannot be undone. Fie, foh, and fum, I smell the blood of a British man.", "When sorrows come, they come not single spies, but in battalions. Virtue itself turns vice, being misapplied.", "Have more than thou showest, speak less than thou knowest. Virtue itself turns vice, being misapplied. There\\u2019s a divinity that shapes our ends, rough-hew them how we will.", "O, beware, my lord, of jealousy! It is the green-eyed monster which doth mock the meat it feeds on. The fault, dear Brutus, is not in our stars, but in ourselves. By my troth, I care not; a man can die but once.", "Poor and content is rich, and rich enough. Though she be but little, she is fierce! In delay there lies no plenty.", "I shall the effect of this good lesson keep as watchman to my heart. The robbed that smiles steals something from the thief. They do not love that do not show their love.", "The fault, dear Brutus, is not in our stars, but in ourselves. What\'s done cannot be undone. Boldness be my friend! Arm me, audacity, from head to foot!", "Boldness be my friend! Arm me, audacity, from head to foot! A fool thinks himself to be wise, but a wise man knows himself to be a fool. Words are easy, like the wind; faithful friends are hard to find.", "Do you think I am easier to be played on than a pipe? There is nothing either good or bad, but thinking makes it so. All\\u2019s well that ends well.", "Love all, trust a few, do wrong to none. Speak what we feel, not what we ought to say.", "Have more than thou showest, speak less than thou knowest. The robbed that smiles steals something from the thief.", "Reputation is an idle and most false imposition; oft got without merit and lost without deserving. Though she be but little, she is fierce!", "There\\u2019s a divinity that shapes our ends, rough-hew them how we will. Boldness be my friend! Arm me, audacity, from head to foot!", "Words are easy, like the wind; faithful friends are hard to find. Speak what we feel, not what we ought to say.", "The evil that men do lives after them; the good is oft interred with their bones. Some are born great, some achieve greatness, and some have greatness thrust upon them.", "Brevity is the soul of wit. The robbed that smiles steals something from the thief. Great floods have flown from simple sources.", "Many a true word hath been spoken in jest. Virtue itself turns vice, being misapplied.", "All\\u2019s well that ends well. We know what we are, but know not what we may be. Boldness be my friend! Arm me, audacity, from head to foot!", "Small cheer and great welcome makes a merry feast. I do love nothing in the world so well as you\\u2014is not that strange?", "Wisely and slow; they stumble that run fast. The evil that men do lives after them; the good is oft interred with their bones.", "Do you think I am easier to be played on than a pipe? True hope is swift and flies with swallows\\u2019 wings.", "I do love nothing in the world so well as you\\u2014is not that strange? Have more than thou showest, speak less than thou knowest. There\\u2019s a divinity that shapes our ends, rough-hew them how we will.", "Men of few words are the best men. There\\u2019s a divinity that shapes our ends, rough-hew them how we will.", "In delay there lies no plenty. Fie, foh, and fum, I smell the blood of a British man. All the world\'s a stage, and all the men and women merely players.", "Cowards die many times before their deaths; the valiant never taste of death but once. Such stuff as dreams are made on.", "Poor and content is rich, and rich enough. Reputation is an idle and most false imposition; oft got without merit and lost without deserving.", "They do not love that do not show their love. Virtue itself turns vice, being misapplied.", "Boldness be my friend! Arm me, audacity, from head to foot! By my troth, I care not; a man can die but once.", "Small cheer and great welcome makes a merry feast. Do you think I am easier to be played on than a pipe?", "There\\u2019s a divinity that shapes our ends, rough-hew them how we will. Boldness be my friend! Arm me, audacity, from head to foot!", "Things won are done; joy\\u2019s soul lies in the doing. Small cheer and great welcome makes a merry feast. Cowards die many times before their deaths; the valiant never taste of death but once."]


def select_random_n_percent(data, n):
    """Selects n% of the records randomly from a list."""
    if n > 0 and n < 1:
        sample_size = max(1, int(n * len(data))
                          )  # Ensure at least 1 item is selected
        return random.sample(data, sample_size)
    else:
        return None


def get_users_from_csv(user_csv):
    """Load user data from a CSV file."""
    try:
        with open(user_csv, mode="r", encoding="utf-8") as file:
            reader = csv.DictReader(file)
            users = list(reader)
            return users
    except FileNotFoundError:
        print(f"File {user_csv} not found.")
        return []


def random_message(msg_list):
    """Selects a random message from a list."""
    return random.choice(msg_list)


def setup_logger(log_filename):
    """Setup the logger."""

    if not log_filename.endswith(".csv"):
        log_filename += ".csv"
    if not os.path.exists(log_filename):
        with open(log_filename, mode="w", newline='') as file:
            writer = csv.writer(file)
            writer.writerow(["Timestamp", "Time", "Agent", "Username",
                            "Target", "Return Code", "Msg Size", "Execution Time (s)", "isWhatsApp"])
    logger = logging.getLogger("CSVLogger")
    logger.setLevel(logging.INFO)

    if logger.hasHandlers():
        logger.handlers.clear()

    file_handler = logging.FileHandler(
        log_filename, mode='a', encoding='utf-8', delay=False)

    formatter = logging.Formatter(
        '%(asctime)s,%(message)s', datefmt='%Y-%m-%d %H:%M:%S')
    file_handler.setFormatter(formatter)

    logger.addHandler(file_handler)

    return logger  # Return the configured logger
